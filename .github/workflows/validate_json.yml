name: Validate Language JSONs

on:
  push:
    paths:
      - 'bin/ltbox/lang/*.json'
  pull_request:
    paths:
      - 'bin/ltbox/lang/*.json'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check JSON Syntax
        run: |
          python3 -c "
          import sys, json, glob

          patterns = ['bin/ltbox/lang/*.json']
          files = []
          for p in patterns:
              files.extend(glob.glob(p))

          files = list(set(files))

          if not files:
              print('Warning: No JSON files found in changed paths.')
              sys.exit(0)

          has_error = False
          for file_path in files:
              try:
                  with open(file_path, 'r', encoding='utf-8') as f:
                      json.load(f)
                  print(f'[OK] {file_path}')
              except Exception as e:
                  print(f'[ERROR] {file_path}: {e}')
                  has_error = True
          
          if has_error:
              print('JSON syntax errors detected.')
              sys.exit(1)
          "